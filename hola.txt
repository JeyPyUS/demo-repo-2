def join_xtodate_p(periodo, df, f_a_calcular):
    '''
    Version parcial del join de los xtodate
    '''
    gap = (df.fecha.values[f_a_calcular] - df.fecha.values[f_a_calcular].astype(f'datetime64[{periodo}]').astype('datetime64[D]')).astype(DATA_TYPE).astype("int")
    idx =  np.arange(len(df))[f_a_calcular] - gap
    return df.rent.values[idx], gap
