def join_xtodate(periodo, df):
    '''
    Version total del join de los xtodate
    '''
    gap = (df.fecha.values - df.fecha.values.astype(f'datetime64[{periodo}]').astype('datetime64[D]')).astype(DATA_TYPE).astype("int")
    idx =  np.arange(len(df)) - gap
    return df.rent.values[idx], gap
